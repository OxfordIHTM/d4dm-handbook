<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>12&nbsp; Data entry/collection and storage using spreadsheets – Data for Decision Makers: Data Concepts and Applications</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./exploratory-data-analysis.html" rel="next">
<link href="./project-based-workflow.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-f4db45487a441faad5dd7eaa04a2f633.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-763b3c111c0adb58ad3275eedc4e943a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-FD0RT8JB4E"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-FD0RT8JB4E', { 'anonymize_ip': true});
</script>


</head>

<body class="floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data-security.html">Data Management</a></li><li class="breadcrumb-item"><a href="./data-entry-storage.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data entry/collection and storage using spreadsheets</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data for Decision Makers: Data Concepts and Applications</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/data4decisonmakers/data-concepts-applications/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Data-for-Decision-Makers--Data-Concepts-and-Applications.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Data-for-Decision-Makers--Data-Concepts-and-Applications.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Concepts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./all-about-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">All about data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Case Studies</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./case_study_one.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data use and analytics in water quality management</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./case_study_two.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Enhancing Local Governance Through Data-Driven Decision-Making in Indonesia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./case-study-three.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The Use of Data in Local Governance - A Michigan Perspective</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./case-study-four.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Enhancing Data-Driven Decision-Making in Local Governance - A Focus on Turkana County</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./case-study-five.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Indigenous Data Governance in the United States</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Management</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-security.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data privacy, security, and protection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data tools</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./all-about-spreadsheets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">All about spreadsheets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./project-based-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Project-based workflow</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-entry-storage.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data entry/collection and storage using spreadsheets</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Exploratory Data Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exploratory-data-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./univariate-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Univariate statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bivariate-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Bivariate statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./epi-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Epidemiological statistics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-spreadsheet-data-be-consistent" id="toc-sec-spreadsheet-data-be-consistent" class="nav-link active" data-scroll-target="#sec-spreadsheet-data-be-consistent"><span class="header-section-number">12.1</span> Be consistent</a></li>
  <li><a href="#sec-spreadsheet-data-good-names" id="toc-sec-spreadsheet-data-good-names" class="nav-link" data-scroll-target="#sec-spreadsheet-data-good-names"><span class="header-section-number">12.2</span> Choose good names for things</a>
  <ul class="collapse">
  <li><a href="#sec-spreadsheet-data-names-rules" id="toc-sec-spreadsheet-data-names-rules" class="nav-link" data-scroll-target="#sec-spreadsheet-data-names-rules"><span class="header-section-number">12.2.1</span> General rules for naming</a></li>
  </ul></li>
  <li><a href="#sec-spreadsheet-data-date" id="toc-sec-spreadsheet-data-date" class="nav-link" data-scroll-target="#sec-spreadsheet-data-date"><span class="header-section-number">12.3</span> Write dates as YYYY-MM-DD</a></li>
  <li><a href="#sec-spreadsheet-no-empty-cells" id="toc-sec-spreadsheet-no-empty-cells" class="nav-link" data-scroll-target="#sec-spreadsheet-no-empty-cells"><span class="header-section-number">12.4</span> No empty cells</a></li>
  <li><a href="#sec-spreadsheet-data-one-thing-cell" id="toc-sec-spreadsheet-data-one-thing-cell" class="nav-link" data-scroll-target="#sec-spreadsheet-data-one-thing-cell"><span class="header-section-number">12.5</span> Put just one thing in a cell</a></li>
  <li><a href="#sec-spreadsheet-data-rectangle" id="toc-sec-spreadsheet-data-rectangle" class="nav-link" data-scroll-target="#sec-spreadsheet-data-rectangle"><span class="header-section-number">12.6</span> Make it a rectangle</a></li>
  <li><a href="#sec-spreadsheet-data-dictionary" id="toc-sec-spreadsheet-data-dictionary" class="nav-link" data-scroll-target="#sec-spreadsheet-data-dictionary"><span class="header-section-number">12.7</span> Create a dictionary</a></li>
  <li><a href="#sec-spreadsheet-data-calculations" id="toc-sec-spreadsheet-data-calculations" class="nav-link" data-scroll-target="#sec-spreadsheet-data-calculations"><span class="header-section-number">12.8</span> No calculations in the raw data file</a></li>
  <li><a href="#sec-spreadsheet-data-colour-highlighting" id="toc-sec-spreadsheet-data-colour-highlighting" class="nav-link" data-scroll-target="#sec-spreadsheet-data-colour-highlighting"><span class="header-section-number">12.9</span> Do not use font colour or highlighting as data</a></li>
  <li><a href="#sec-spreadsheet-data-backup" id="toc-sec-spreadsheet-data-backup" class="nav-link" data-scroll-target="#sec-spreadsheet-data-backup"><span class="header-section-number">12.10</span> Make backups</a></li>
  <li><a href="#sec-spreadsheet-data-validation" id="toc-sec-spreadsheet-data-validation" class="nav-link" data-scroll-target="#sec-spreadsheet-data-validation"><span class="header-section-number">12.11</span> Use data validation to avoid errors</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/data4decisonmakers/data-concepts-applications/edit/main/12-data-entry-storage.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data-security.html">Data Management</a></li><li class="breadcrumb-item"><a href="./data-entry-storage.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data entry/collection and storage using spreadsheets</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-data-entry-storage" class="quarto-section-identifier"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data entry/collection and storage using spreadsheets</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Spreadsheets are often used as a multi-purpose tool for data entry, storage, analysis, and visualisation. Most spreadsheet software available allows users to perform all of these tasks. However, spreadsheets are best suited to data entry and storage. Analysis and visualisation should be done separately either by using other data tools or at least in a separate copy of the data file in order to reduce the risk of contaminating or accidentally changing the raw data in the spreadsheet.</p>
<p>Spreadsheets, by design, make humans format data to be viewed by the human eye rather than to be readable by a machine <span class="citation" data-cites="murrell_data_2013">(<a href="references.html#ref-murrell_data_2013" role="doc-biblioref">Murrell, 2013</a>)</span>. Data structured as such require greater amount of effort, usually in computer code, to be able to extract the information needed for analysis. However, if the initial structure is such that it is easily readable by a machine, the effort leading to analysis is much more simplified.</p>
<p>In this chapter, we discuss best practices in using spreadsheets as a data entry and data storage tool and provide specific recommendations for organising spreadsheet data in a way that both humans and computers can read. Following these recommendations allows the creation of spreadsheets that minimise errors, are easy for computers to process, and facilitate collaboration and public access. These well-structured spreadsheets integrate with reproducible methods, serving as a reliable foundation for robust analytic workflows.</p>
<section id="sec-spreadsheet-data-be-consistent" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="sec-spreadsheet-data-be-consistent"><span class="header-section-number">12.1</span> Be consistent</h2>
<p>Consistency is key in data organisation. Strive for uniformity in your data entry and organisation practices. By maintaining this consistency from the start, you can save yourself and your collaborators from the hassle of reconciling inconsistencies later on.</p>
<p>Following are some examples of being consistent and why it is important. Some of these examples are also part of the recommendations listed here.</p>
<ul>
<li><strong>Use consistent codes for categorical variables.</strong></li>
</ul>
<p>For a categorical variable like the sex, use a single common value for males (e.g., “male”), and a single common value for females (e.g., “female”). Do not sometimes write “M,” sometimes “male,” and sometimes “Male.” Pick one and stick to it. In order to limit the occurrence of this inconsistency, you can enforce a data validation rule for this variable (see <a href="#sec-spreadsheet-data-validation" class="quarto-xref"><span>Section 12.11</span></a>).</p>
<ul>
<li><strong>Use a consistent fixed code for any missing values.</strong></li>
</ul>
<p>It is ideal to have every cell filled in so that distinguishing between truly missing values and unintentionally missing values is more straightforward. Decide right at the outset what value to use for missing values and stick with that value throughout. Do not use a note explaining why a value is missing in place of the data itself. Rather, make a separate column with such notes.</p>
<ul>
<li><strong>Use consistent variable names.</strong></li>
</ul>
<p>Name variables exactly the same way throughout one file and across every other file relevant to the project. If naming is inconsistent for the same variable, those working with the data will have to work out that these are all really the same thing. See <a href="#sec-spreadsheet-data-good-names" class="quarto-xref"><span>Section 12.2</span></a> for more discussion on best practices in naming things within a data file. See <a href="project-based-workflow.html#sec-spreadsheet-file-name" class="quarto-xref"><span>Section 11.2.3</span></a> for an in-depth discussion on best practices in naming files.</p>
<ul>
<li><strong>Use consistent subject identifiers.</strong></li>
</ul>
<p>Create consistent and unique subject identifiers to avoid extra work in figuring out which subject/record if which.</p>
<ul>
<li><strong>Use a consistent data layout in multiple files.</strong></li>
</ul>
<p>If your data are in multiple files and you use different layouts in different files, it will be extra work for the analyst to combine the files into one dataset for analysis. With a consistent structure, it will be easy to automate this process.</p>
<ul>
<li><strong>Use consistent file names.</strong></li>
</ul>
<p>Have some system for naming files. Keeping a consistent file naming scheme will help ensure that your files remain well organised, and it will make it easier to batch process the files if you need to. See an in-depth discussion of file naming in <a href="project-based-workflow.html#sec-spreadsheet-file-name" class="quarto-xref"><span>Section 11.2.3</span></a>.</p>
<ul>
<li><strong>Use a consistent format for all dates.</strong></li>
</ul>
<p>Preferably use the standard format <code>YYYY-MM-DD</code>, for example, 2015-08-01. If sometimes you write 8/1/2015 and sometimes 8-1-15, it will be more difficult to use the dates in analyses or data visualisations. See <a href="#sec-spreadsheet-data-date" class="quarto-xref"><span>Section 12.3</span></a> for more discussion on this.</p>
<ul>
<li><strong>Use consistent phrases in your notes.</strong></li>
</ul>
<p>If you have a separate column of notes (e.g., <code>"dead"</code>), be consistent in what you write. Do not sometimes write <code>"dead"</code> and sometimes <code>"Dead"</code>.</p>
<ul>
<li><strong>Be careful about extra spaces within cells.</strong></li>
</ul>
<p>A blank cell is different than a cell that contains a single space. And <code>"male"</code> is different from <code>" male "</code> (i.e., with spaces at the beginning and end).</p>
</section>
<section id="sec-spreadsheet-data-good-names" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="sec-spreadsheet-data-good-names"><span class="header-section-number">12.2</span> Choose good names for things</h2>
<p>It is important to pick good names for things such as variables. This can be hard, and so it is worth putting some time and thought into it. <a href="project-based-workflow.html#sec-spreadsheet-file-name" class="quarto-xref"><span>Section 11.2.3</span></a> provides some general principles for naming files that can also be used when naming variables in data.</p>
<section id="sec-spreadsheet-data-names-rules" class="level3" data-number="12.2.1">
<h3 data-number="12.2.1" class="anchored" data-anchor-id="sec-spreadsheet-data-names-rules"><span class="header-section-number">12.2.1</span> General rules for naming</h3>
<ul>
<li>Do not use spaces, either in variable names or file names</li>
</ul>
<p>Spaces make programming harder. An analyst will need to surround a name that contains spaces in double quotes in order to refer to it. Use underscores (<code>_</code>) or hyphens (<code>-</code>) instead of spaces. Do not use a mixture of underscores and hyphens; pick one and be consistent.</p>
<ul>
<li>No extraneous spaces at the start and/or end of variable names</li>
</ul>
<p>Be careful about extraneous spaces at the beginning or end of a variable name. <code>"sex"</code> is different from <code>"sex "</code> (with an extra space at the end) or <code>" sex"</code> (with an extra space at the start).</p>
<ul>
<li>Avoid special characters, except for underscores and hyphens</li>
</ul>
<p>Other symbols (<code>$</code>, <code>@</code>, <code>%</code>, <code>#</code>, <code>&amp;</code>, <code>*</code>, <code>(</code>, <code>)</code>, <code>!</code>, <code>/</code>, etc.) often have special meaning in programming languages, and so they can be harder to handle. They are also a bit harder to type.</p>
<p>The main principle in choosing names, whether for variables or for file names, is short, but meaningful. So not too short. The following table (adapted from <a href="https://datacarpentry.github.io/spreadsheet-ecology-lesson/02-common-mistakes">The Data Carpentry lesson on using spreadsheets</a>) show good and bad example variables names.</p>
<div class="cell">
<div id="tbl-variable-names" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-variable-names-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;12.1: Examples of good and bad variable names
</figcaption>
<div aria-describedby="tbl-variable-names-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Good name</th>
<th style="text-align: left;">Good alternative</th>
<th style="text-align: left;">Avoid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">max_temp_c</td>
<td style="text-align: left;">MaxTemp</td>
<td style="text-align: left;">Maximum Temp (°C)</td>
</tr>
<tr class="even">
<td style="text-align: left;">precipitation_mm</td>
<td style="text-align: left;">Precipitation</td>
<td style="text-align: left;">precmm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mean_year_growth</td>
<td style="text-align: left;">MeanYearGrowth</td>
<td style="text-align: left;">Mean growth/year</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex</td>
<td style="text-align: left;">sex</td>
<td style="text-align: left;">M/F</td>
</tr>
<tr class="odd">
<td style="text-align: left;">weight</td>
<td style="text-align: left;">weight</td>
<td style="text-align: left;">w.</td>
</tr>
<tr class="even">
<td style="text-align: left;">cell_type</td>
<td style="text-align: left;">CellType</td>
<td style="text-align: left;">Cell type</td>
</tr>
<tr class="odd">
<td style="text-align: left;">observation_01</td>
<td style="text-align: left;">first_observation</td>
<td style="text-align: left;">1st Obs.</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The first column of variable names use the <a href="https://en.wikipedia.org/wiki/Snake_case"><em>snake case</em></a> naming convention which uses an underscore to replace a space and letters are in lower case. The second column of good alternative variable names use the <a href="https://en.wikipedia.org/wiki/Camel_case"><em>camel case</em></a> naming convention in which phrases are written without spaces or punctuation and with capitalised words.</p>
</section>
</section>
<section id="sec-spreadsheet-data-date" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="sec-spreadsheet-data-date"><span class="header-section-number">12.3</span> Write dates as YYYY-MM-DD</h2>
<div id="fig-comic-dates" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-comic-dates-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://imgs.xkcd.com/comics/iso_8601.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;12.1: ISO 8601 from https://xkcd.com/1179/"><img src="https://imgs.xkcd.com/comics/iso_8601.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-comic-dates-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.1: ISO 8601 from https://xkcd.com/1179/
</figcaption>
</figure>
</div>
<p>When entering dates, we strongly recommend using the global <em>ISO 8601</em> standard, <code>YYYY-MM-DD</code>, such as 2013-02-27.</p>
<p>Microsoft Excel’s treatment of dates can cause problems in data. It stores them internally as a number, with different conventions on Windows and Macs (see <a href="#nte-excel-dates" class="quarto-xref">Note&nbsp;<span>12.1</span></a>). So, you may need to manually check the integrity of your data when they come out of Excel.</p>
<div id="nte-excel-dates" class="callout callout-style-default callout-note callout-titled" title="Date systems in Microsoft Excel">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note&nbsp;12.1: Date systems in Microsoft Excel
</div>
</div>
<div class="callout-body-container callout-body">
<p>Excel supports two date systems, the <em>1900 date system</em> and the <em>1904 date system</em>. Each date system uses a unique starting date from which all other workbook dates are calculated. All newer versions of Excel calculate dates based on the 1900 date system, while older versions used the 1904 system.</p>
<p>When you copy dates from a workbook created in an earlier version to a workbook created in a newer version, they will be converted automatically unless the option to <code>"Automatically convert date system"</code> is disabled in <code>Preferences &gt; Edit &gt; Date</code> Options. If this option is disabled, you will receive a message asking whether the dates should be converted when pasted. You have two options. You can convert the dates to use the 1900 date system (recommended). This option makes the dates compatible with other dates in the workbook. Or you can keep the 1904 date system for the pasted dates only.</p>
<p><strong>The 1900 date system</strong></p>
<p>In the 1900 date system, dates are calculated by using <em>January 1, 1900</em>, as a starting point. When you enter a date, it is converted into a serial number that represents the number of days elapsed since January 1, 1900. For example, if you enter July 5, 2011, Excel converts the date to the serial number 40729. This is the default date system in Excel for Windows, Excel 2016 for Mac, and Excel for Mac 2011. If you choose to convert the pasted data, Excel adjusts the underlying values, and the pasted dates match the dates that you copied.</p>
<p><strong>The 1904 date system</strong></p>
<p>In the 1904 date system, dates are calculated by using <em>January 1, 1904</em>, as a starting point. When you enter a date, it is converted into a serial number that represents the number of days elapsed since January 1, 1904. For example, if you enter July 5, 2011, Excel converts the date to the serial number 39267. This is the default date system in earlier versions of Excel for Mac. If you choose not to convert the data and keep the 1904 date system, the pasted dates vary from the dates that you copied.</p>
<p><strong>The difference between the date systems</strong></p>
<p>Because the two date systems use different starting days, the same date is represented by different serial numbers in each date system. For example, July 5, 2011, can have two different serial numbers, as follows:</p>
<div id="tbl-excel-date-system" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-excel-date-system-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;12.2: Comparison of Excel’s 1900 and 1904 date systems
</figcaption>
<div aria-describedby="tbl-excel-date-system-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: right;">Date System</th>
<th style="text-align: right;">Serial Number</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1900</td>
<td style="text-align: right;">40729</td>
</tr>
<tr class="even">
<td style="text-align: right;">1904</td>
<td style="text-align: right;">39267</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>The difference between the two date systems is <em>1,462 days</em>. This means that the serial number of a date in the 1900 date system is always 1,462 days greater than the serial number of the same date in the 1904 date system. 1,462 days is equal to <em>four years and one day (including one leap day)</em>.</p>
<p>*taken from <a href="https://support.microsoft.com/en-gb/office/date-systems-in-excel-e7fe7167-48a9-4b96-bb53-5612a800b487#:~:text=The%201900%20date%20system,-In%20the%201900&amp;text=This%20is%20the%20default%20date,the%20dates%20that%20you%20copied.">Microsoft Support documentation</a></p>
</div>
</div>
<p>To avoid these issues with dates when using spreadsheets (specifically Excel), we recommend the following:</p>
<ul>
<li>Use a plain text format for columns in an Excel worksheet that are going to contain dates</li>
</ul>
<p>Doing so will avoid automatic conversion of these variables into often unpredictable formats. This can be done through the following steps:</p>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row quarto-layout-valign-bottom">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-date-format-text-01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-date-format-text-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/date_format_text_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;12.2: Create date variable"><img src="images/date_format_text_01.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-date-format-text-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.2: Create date variable
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-date-format-text-02" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-date-format-text-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/date_format_text_02.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;12.3: Select date variable"><img src="images/date_format_text_02.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-date-format-text-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.3: Select date variable
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-date-format-text-03" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-date-format-text-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/date_format_text_03.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;12.4: Set format to text"><img src="images/date_format_text_03.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-date-format-text-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.4: Set format to text
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Step 1: Create a date variable (see <a href="#fig-date-format-text-01" class="quarto-xref">Figure&nbsp;<span>12.2</span></a>).</p>
<p>Step 2. Select the date variable you created (see <a href="#fig-date-format-text-02" class="quarto-xref">Figure&nbsp;<span>12.3</span></a>).</p>
<p>Step 3: In the menu bar, select <em>Format –&gt; Cells –&gt; Choose “Text”</em> on the left (see <a href="#fig-date-format-text-03" class="quarto-xref">Figure&nbsp;<span>12.4</span></a>).</p>
<p>This approach will only work if you are creating the date variable first and when no date values have been entered yet. If you do this on a date variable that already contain dates, Excel will convert them to a text value of their underlying numeric representation (as described in <a href="#nte-excel-dates" class="quarto-xref">Note&nbsp;<span>12.1</span></a>).</p>
<ul>
<li>Place an apostrophe at the start of a date value entry</li>
</ul>
<p>Another way to force Excel to treat dates as text is to begin the date with an apostrophe, like this: <code>'2014-06-14</code>. Excel will treat the cells as text, but the apostrophe will not appear when you view the spreadsheet or export it to other formats. This is a handy trick, but it requires impeccable diligence and consistency.</p>
<div id="fig-date_format_text_05" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-date_format_text_05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/date_format_text_05.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;12.5: Enter an apostrophe followed by YYYY-MM-DD date format"><img src="images/date_format_text_05.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-date_format_text_05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.5: Enter an apostrophe followed by YYYY-MM-DD date format
</figcaption>
</figure>
</div>
<ul>
<li>Create three separate columns with year, month, and day</li>
</ul>
<p>These will be ordinary numbers, and so Excel will not mess them up. If there is an existing date variable already, you can convert that to year, month, and day columns by using the built-in date functions in Excel that extract year (<a href="#fig-date-format-text-06" class="quarto-xref">Figure&nbsp;<span>12.6</span></a>), month (<a href="#fig-date-format-text-07" class="quarto-xref">Figure&nbsp;<span>12.7</span></a>), and day (<a href="#fig-date-format-text-08" class="quarto-xref">Figure&nbsp;<span>12.8</span></a>) values from a date variable.</p>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row quarto-layout-valign-bottom">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-date-format-text-06" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-date-format-text-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/date_format_text_06.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;12.6: Extract year from date value"><img src="images/date_format_text_06.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-date-format-text-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.6: Extract year from date value
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-date-format-text-07" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-date-format-text-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/date_format_text_07.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;12.7: Extract month from date value"><img src="images/date_format_text_07.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-date-format-text-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.7: Extract month from date value
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-date-format-text-08" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-date-format-text-08-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/date_format_text_08.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;12.8: Extract year from date value"><img src="images/date_format_text_08.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-date-format-text-08-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.8: Extract year from date value
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>Represent dates as an 8-digit integer of the form YYYYMMDD</li>
</ul>
<p>For example, <code>20140614</code> for <code>2014-06-14</code> (see <a href="#fig-date-format-text-09" class="quarto-xref">Figure&nbsp;<span>12.9</span></a>).</p>
<div id="fig-date-format-text-09" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-date-format-text-09-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/date_format_text_09.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;12.9: Date value as text in YYYYMMDD format"><img src="images/date_format_text_09.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-date-format-text-09-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.9: Date value as text in YYYYMMDD format
</figcaption>
</figure>
</div>
</section>
<section id="sec-spreadsheet-no-empty-cells" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="sec-spreadsheet-no-empty-cells"><span class="header-section-number">12.4</span> No empty cells</h2>
<p>Fill in all cells. Use some common code for missing data to make it clear that the data are known to be missing rather than unintentionally left blank.</p>
</section>
<section id="sec-spreadsheet-data-one-thing-cell" class="level2" data-number="12.5">
<h2 data-number="12.5" class="anchored" data-anchor-id="sec-spreadsheet-data-one-thing-cell"><span class="header-section-number">12.5</span> Put just one thing in a cell</h2>
<p>Your spreadsheet should have cells that each contain one piece of data only. Putting more than one type of data value in a cell is not considered best practice.</p>
<p>For example, you might have a column with information on year (containing values of either <em>2022</em>, <em>2023</em>, or <em>2024</em>) and <code>sex</code> (<em>Male</em> or <em>Female</em>) as <code>year-sex</code> such as <code>2022-Male</code>, <code>2022-Female</code>, and so on and so forth. It would be better to separate this into <code>year</code> and <code>sex</code> columns (containing <em>2022</em> and <em>Male</em>).</p>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row quarto-layout-valign-bottom">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-year-sex-01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-year-sex-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/year_sex_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;12.10: Combined year-sex variable"><img src="images/year_sex_01.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-year-sex-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.10: Combined year-sex variable
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-year-sex-02" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-year-sex-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/year_sex_02.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;12.11: Year and sex as separate variables"><img src="images/year_sex_02.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-year-sex-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.11: Year and sex as separate variables
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Or you might include units alongside measurements such as weight. It is better to have a variable for the weight and then a separate variable for the units.</p>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row quarto-layout-valign-bottom">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-weight-unit-01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-weight-unit-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/weight_unit_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;12.12: Combined weight-unit variable"><img src="images/weight_unit_01.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-weight-unit-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.12: Combined weight-unit variable
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-weight-unit-02" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-weight-unit-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/weight_unit_02.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;12.13: Separate weight and unit variables"><img src="images/weight_unit_02.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-weight-unit-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.13: Separate weight and unit variables
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>It is even better to just have a variable for weight and then document the units used in a separate data dictionary (see <a href="#sec-spreadsheet-data-dictionary" class="quarto-xref"><span>Section 12.7</span></a> on creating a data dictionary).</p>
<p>Finally, do not merge cells. It might look pretty, but you end up breaking the rule of no empty cells.</p>
</section>
<section id="sec-spreadsheet-data-rectangle" class="level2" data-number="12.6">
<h2 data-number="12.6" class="anchored" data-anchor-id="sec-spreadsheet-data-rectangle"><span class="header-section-number">12.6</span> Make it a rectangle</h2>
<p>A single big rectangle with rows corresponding to subjects and columns corresponding to variables is the best layout for data within a spreadsheet. The first row should always contain variable names. Do not use more than one row for the variable names.</p>
<div id="fig-spreadsheet-rectangular-data" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-spreadsheet-rectangular-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/rectangular_data.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figure&nbsp;12.14: Data in spreadsheet with rectangular layout"><img src="images/rectangular_data.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-spreadsheet-rectangular-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.14: Data in spreadsheet with rectangular layout
</figcaption>
</figure>
</div>
</section>
<section id="sec-spreadsheet-data-dictionary" class="level2" data-number="12.7">
<h2 data-number="12.7" class="anchored" data-anchor-id="sec-spreadsheet-data-dictionary"><span class="header-section-number">12.7</span> Create a dictionary</h2>
<p>Having a separate file (see <a href="#fig-project-metadata-file" class="quarto-xref">Figure&nbsp;<span>12.15</span></a>) that outlines all variables can be very helpful, particularly if it’s organised in a structured layout so data analysts can use it effectively in their analyses. We recommend that this <em>data dictionary</em> includes the following information:</p>
<ol type="1">
<li>The <strong>precise variable names</strong> as they appear in the dataset.</li>
<li>A <strong>detailed description</strong> explaining what the variable represents.</li>
<li>The <strong>measurement units</strong> associated with each variable.</li>
<li>The <strong>list of possible values</strong> (for categorical variables) and/or <strong>typical range of values expected</strong> (for numerical variables) for that variable.</li>
</ol>
<p>An example of this data dictionary within an accompanying Word document metadata in a project-based workflow is shown in <a href="#fig-project-metadata-contents" class="quarto-xref">Figure&nbsp;<span>12.16</span></a>.</p>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row quarto-layout-valign-bottom">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-project-metadata-file" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-project-metadata-file-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/project_based_workflow_05.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Figure&nbsp;12.15: A project-based workflow structure with a separate file for metadata"><img src="images/project_based_workflow_05.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-project-metadata-file-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.15: A project-based workflow structure with a separate file for metadata
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-project-metadata-contents" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-project-metadata-contents-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/project_metadata_docx.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Figure&nbsp;12.16: A recommended layout and contents of a project metadata containing a data dictionary"><img src="images/project_metadata_docx.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-project-metadata-contents-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.16: A recommended layout and contents of a project metadata containing a data dictionary
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>An alternative to a separate metadata and data dictionary file is to include this documentation as a separate worksheet within the spreadsheet containing the data.</p>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row quarto-layout-valign-bottom">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-project-data-raw-file" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-project-data-raw-file-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/project_based_workflow_03.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Figure&nbsp;12.17: A project-based workflow structure with separate file for data"><img src="images/project_based_workflow_03.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-project-data-raw-file-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.17: A project-based workflow structure with separate file for data
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-project-data-raw-spreadsheet" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-project-data-raw-spreadsheet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/spreadsheet_data_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Figure&nbsp;12.18: Project spreadsheet with raw data in worksheet called “main”"><img src="images/spreadsheet_data_01.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-project-data-raw-spreadsheet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.18: Project spreadsheet with raw data in worksheet called “main”
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-project-metadata-spreadsheet" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-project-metadata-spreadsheet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/spreadsheet_data_04.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Figure&nbsp;12.19: Project spreadsheet with metadata/dictionary in worksheet called “metadata”"><img src="images/spreadsheet_data_04.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-project-metadata-spreadsheet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.19: Project spreadsheet with metadata/dictionary in worksheet called “metadata”
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="sec-spreadsheet-data-calculations" class="level2" data-number="12.8">
<h2 data-number="12.8" class="anchored" data-anchor-id="sec-spreadsheet-data-calculations"><span class="header-section-number">12.8</span> No calculations in the raw data file</h2>
<p>Excel files often come with various calculations and graphs included alongside the data itself. We strongly recommend keeping your primary data file free from any additional content - only raw data should be present. This is because editing the same file for calculations can lead to accidental errors. For instance, when you open a file and start typing without selecting a cell, the text might end up in unexpected cells, causing problems during analysis. To prevent this, protect your main data file from changes, keep it backed up, and refrain from making edits. If you need to perform analyses or create graphs, work on a duplicate of the original file.</p>
</section>
<section id="sec-spreadsheet-data-colour-highlighting" class="level2" data-number="12.9">
<h2 data-number="12.9" class="anchored" data-anchor-id="sec-spreadsheet-data-colour-highlighting"><span class="header-section-number">12.9</span> Do not use font colour or highlighting as data</h2>
<p>You might be tempted to highlight particular cells with suspicious data, or rows that should be ignored. Or the font or font colour might have some meaning. Instead, add another column with an indicator variable (e.g., ”trusted” with values TRUE or FALSE).</p>
<p>Another possible use of highlighting would be to indicate males and females in a mouse study by highlighting the corresponding rows in different colours. But rather than use highlighting to indicate sex, it is better to include a sex column, with values Male or Female.</p>
</section>
<section id="sec-spreadsheet-data-backup" class="level2" data-number="12.10">
<h2 data-number="12.10" class="anchored" data-anchor-id="sec-spreadsheet-data-backup"><span class="header-section-number">12.10</span> Make backups</h2>
<p>Regularly back up your data by storing copies in multiple locations. Consider using a formal version control system such as <em>git</em> (though it’s not ideal for data files). Keep every version of your data files and label them with version numbers, like <code>file_v1.xlsx</code>, <code>file_v2.xlsx</code>, and so on and so forth. For this, the guidance on good file names discussed in <a href="project-based-workflow.html#sec-spreadsheet-file-name" class="quarto-xref"><span>Section 11.2.3</span></a> is a good reference to follow for naming your file versions. Once you’ve finished entering data or if taking a break, protect the file from accidental changes by setting it to <em>read-only</em> as described below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Windows</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">macOS</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>1, Right-click the file in File Explorer or select the file and then click on the triple dot icon in File Explorer as shown in <a href="#fig-read-only-windows-01" class="quarto-xref">Figure&nbsp;<span>12.20</span></a>.</p>
<div id="fig-read-only-windows-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-read-only-windows-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/read_only_windows_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Figure&nbsp;12.20: See more file options in File Explorer"><img src="images/read_only_windows_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-read-only-windows-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.20: See more file options in File Explorer
</figcaption>
</figure>
</div>
<ol start="2" type="1">
<li>In the drop-down menu, choose <code>Properties</code> as shown in <a href="#fig-read-only-windows-02" class="quarto-xref">Figure&nbsp;<span>12.21</span></a>.</li>
</ol>
<div id="fig-read-only-windows-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-read-only-windows-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/read_only_windows_02.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Figure&nbsp;12.21: Select Properties option in the drop-down menu"><img src="images/read_only_windows_02.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:30.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-read-only-windows-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.21: Select Properties option in the drop-down menu
</figcaption>
</figure>
</div>
<ol start="3" type="1">
<li>In the pop-up menu, navigate to the <code>General</code> tab, check the <code>Attributes</code> box for <code>Read-only</code>, and confirm with <code>OK</code> as shown in <a href="#fig-read-only-windows-03" class="quarto-xref">Figure&nbsp;<span>12.22</span></a>.</li>
</ol>
<div id="fig-read-only-windows-03" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-read-only-windows-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/read_only_windows_03.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Figure&nbsp;12.22: Set the file to read-only"><img src="images/read_only_windows_03.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-read-only-windows-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.22: Set the file to read-only
</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<ol type="1">
<li>Open Finder and right-click on the file.</li>
</ol>
<div id="fig-read-only-mac-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-read-only-mac-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/read_only_mac_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Figure&nbsp;12.23: Right-click on the spreadsheet file"><img src="images/read_only_mac_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-read-only-mac-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.23: Right-click on the spreadsheet file
</figcaption>
</figure>
</div>
<ol start="2" type="1">
<li>Select <code>Get Info</code> then go to <code>Sharing &amp; Permissions</code>.</li>
</ol>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row quarto-layout-valign-bottom">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-read-only-mac-02" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-read-only-mac-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/read_only_mac_02.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="Figure&nbsp;12.24: Select Get Info"><img src="images/read_only_mac_02.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-read-only-mac-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.24: Select Get Info
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-read-only-mac-03" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-read-only-mac-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/read_only_mac_03.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25" title="Figure&nbsp;12.25: Go to Sharing &amp; Permissions"><img src="images/read_only_mac_03.png" class="img-fluid figure-img" style="width:30.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-read-only-mac-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.25: Go to Sharing &amp; Permissions
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ol start="3" type="1">
<li>Set your privileges to <code>Read only</code>.</li>
</ol>
<div id="fig-read-only-mac-04" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-read-only-mac-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/read_only_mac_04.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26" title="Figure&nbsp;12.26: Set privileges to Read only"><img src="images/read_only_mac_04.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:30.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-read-only-mac-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.26: Set privileges to Read only
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Another option is to password protect the worksheet in the spreadsheet that has the data.</p>
<ol type="1">
<li>Select the worksheet to password-protect and then go to <code>Review</code> as shown in <a href="#fig-password-spreadsheet-01" class="quarto-xref">Figure&nbsp;<span>12.31</span></a>.</li>
</ol>
<div id="fig-password-spreadsheet-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-password-spreadsheet-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/password_spreadsheet_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27" title="Figure&nbsp;12.27: Go to Review"><img src="images/password_spreadsheet_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-password-spreadsheet-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.27: Go to Review
</figcaption>
</figure>
</div>
<ol start="2" type="1">
<li>Select <code>Protect Sheet</code> as shown in <a href="#fig-password-spreadsheet-02" class="quarto-xref">Figure&nbsp;<span>12.28</span></a>.</li>
</ol>
<div id="fig-password-spreadsheet-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-password-spreadsheet-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/password_spreadsheet_02.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28" title="Figure&nbsp;12.28: Select Protect Sheet"><img src="images/password_spreadsheet_02.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-password-spreadsheet-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.28: Select Protect Sheet
</figcaption>
</figure>
</div>
<ol start="3" type="1">
<li>Enter password to protect worksheet as shown in <a href="#fig-password-spreadsheet-03" class="quarto-xref">Figure&nbsp;<span>12.29</span></a>.</li>
</ol>
<div id="fig-password-spreadsheet-03" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-password-spreadsheet-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/password_spreadsheet_03.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29" title="Figure&nbsp;12.29: Enter password to protect worksheet"><img src="images/password_spreadsheet_03.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-password-spreadsheet-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.29: Enter password to protect worksheet
</figcaption>
</figure>
</div>
<ol start="4" type="1">
<li>Re-enter password to confirm protection as shown in <a href="#fig-password-spreadsheet-04" class="quarto-xref">Figure&nbsp;<span>12.30</span></a>.</li>
</ol>
<div id="fig-password-spreadsheet-04" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-password-spreadsheet-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/password_spreadsheet_04.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30" title="Figure&nbsp;12.30: Re-enter password to confirm protection"><img src="images/password_spreadsheet_04.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-password-spreadsheet-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.30: Re-enter password to confirm protection
</figcaption>
</figure>
</div>
<p>Password protection can also be applied to the whole spreadsheet workbook.</p>
<ol type="1">
<li>Open the spreadsheet to password-protect and then go to <code>Review</code> as shown in <a href="#fig-password-spreadsheet-01" class="quarto-xref">Figure&nbsp;<span>12.31</span></a>.</li>
</ol>
<div id="fig-password-spreadsheet-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-password-spreadsheet-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/password_spreadsheet_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31" title="Figure&nbsp;12.31: Go to Review"><img src="images/password_spreadsheet_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-password-spreadsheet-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.31: Go to Review
</figcaption>
</figure>
</div>
<ol start="2" type="1">
<li>Select <code>Protect Workbook</code> as shown in <a href="#fig-password-spreadsheet-05" class="quarto-xref">Figure&nbsp;<span>12.32</span></a>.</li>
</ol>
<div id="fig-password-spreadsheet-05" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-password-spreadsheet-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/password_spreadsheet_05.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32" title="Figure&nbsp;12.32: Select Protect Workbook"><img src="images/password_spreadsheet_05.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-password-spreadsheet-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.32: Select Protect Workbook
</figcaption>
</figure>
</div>
<ol start="3" type="1">
<li>Enter password to protect workbook as shown in <a href="#fig-password-spreadsheet-06" class="quarto-xref">Figure&nbsp;<span>12.33</span></a>.</li>
</ol>
<div id="fig-password-spreadsheet-06" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-password-spreadsheet-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/password_spreadsheet_06.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33" title="Figure&nbsp;12.33: Enter password to protect workbook"><img src="images/password_spreadsheet_06.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-password-spreadsheet-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.33: Enter password to protect workbook
</figcaption>
</figure>
</div>
<ol start="4" type="1">
<li>Re-enter password to confirm workbook protection as shown in <a href="#fig-password-spreadsheet-07" class="quarto-xref">Figure&nbsp;<span>12.34</span></a>.</li>
</ol>
<div id="fig-password-spreadsheet-07" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-password-spreadsheet-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/password_spreadsheet_07.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34" title="Figure&nbsp;12.34: Re-enter password to confirm workbook protection"><img src="images/password_spreadsheet_07.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-password-spreadsheet-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.34: Re-enter password to confirm workbook protection
</figcaption>
</figure>
</div>
<div id="imp-backup-data" class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important&nbsp;12.1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Remember, always back up your data!</p>
</div>
</div>
</section>
<section id="sec-spreadsheet-data-validation" class="level2" data-number="12.11">
<h2 data-number="12.11" class="anchored" data-anchor-id="sec-spreadsheet-data-validation"><span class="header-section-number">12.11</span> Use data validation to avoid errors</h2>
<p>When handling data entry tasks using spreadsheets, it’s crucial to aim for accuracy and comfort to minimise errors and reduce physical strain. Excel provides a helpful <code>Data Validation</code> feature that can prevent errors during data entry.</p>
<p>To use this feature:</p>
<ol type="1">
<li>Choose the column you wish to validate. In <a href="#fig-data-validation-01" class="quarto-xref">Figure&nbsp;<span>12.35</span></a>, the data entry for the <code>age</code> variable is to be validated.</li>
</ol>
<div id="fig-data-validation-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-data-validation-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/data_validation_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35" title="Figure&nbsp;12.35: Add validation to the age column/variable"><img src="images/data_validation_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-data-validation-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.35: Add validation to the age column/variable
</figcaption>
</figure>
</div>
<ol start="2" type="1">
<li>Go to the menu bar and select <code>Data --&gt; Data Tools --&gt; Data Validation</code> as shown in</li>
</ol>
<div id="fig-data-validation-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-data-validation-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/data_validation_02.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36" title="Figure&nbsp;12.36: Select Data Validation in Data Tools"><img src="images/data_validation_02.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-data-validation-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.36: Select Data Validation in Data Tools
</figcaption>
</figure>
</div>
<ol start="3" type="1">
<li>Set up validation criteria such as:
<ul>
<li>Whole numbers within a specified range</li>
<li>Decimal numbers within a specified range</li>
<li>A predefined list of acceptable values</li>
<li>Text with length restrictions</li>
</ul></li>
</ol>
<p>In <a href="#fig-data-validation-03" class="quarto-xref">Figure&nbsp;<span>12.37</span></a>, we set validation for age variable to allow only whole numbers ranging from 120 to 191 (inclusive). The <code>Ignore blank</code> option is ticked so that blank entry will be accepted.</p>
<div id="fig-data-validation-03" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-data-validation-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/data_validation_03.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37" title="Figure&nbsp;12.37: Setup validation criteria for age variable"><img src="images/data_validation_03.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-data-validation-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.37: Setup validation criteria for age variable
</figcaption>
</figure>
</div>
<ol start="4" type="1">
<li>Add title and message to guide data entry input as shown in <a href="#fig-data-validation-04" class="quarto-xref">Figure&nbsp;<span>12.38</span></a>.</li>
</ol>
<div id="fig-data-validation-04" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-data-validation-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/data_validation_04.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38" title="Figure&nbsp;12.38: Add title and message guide for data entry"><img src="images/data_validation_04.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-data-validation-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.38: Add title and message guide for data entry
</figcaption>
</figure>
</div>
<ol start="5" type="1">
<li>Add error alert to show up when incorrect data entry input is made as shown in <a href="#fig-data-validation-05" class="quarto-xref">Figure&nbsp;<span>12.39</span></a></li>
</ol>
<div id="fig-data-validation-05" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-data-validation-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/data_validation_05.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39" title="Figure&nbsp;12.39: Add error alert to show up when incorrect data entry input is made"><img src="images/data_validation_05.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-data-validation-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.39: Add error alert to show up when incorrect data entry input is made
</figcaption>
</figure>
</div>
<p>Microsoft Support has further documentation and guidance on how to apply data validation to cells <a href="https://support.microsoft.com/en-us/office/apply-data-validation-to-cells-29fecbcc-d1b9-42c1-9d76-eff3ce5f7249">here</a>.</p>
<p>Additionally, formatting cells as “Text” can prevent unintended changes to data like dates or names. In <a href="#sec-spreadsheet-data-date" class="quarto-xref"><span>Section 12.3</span></a>, the steps to change formatting of cells is described and demonstrated.</p>
<p>While these steps may seem tedious, they are valuable in maintaining data integrity and minimising errors during entry.</p>
<!-- ## Save the data in plain text files {#sec-spreadsheet-data-plain-text} -->
<p><br> <br></p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-murrell_data_2013" class="csl-entry" role="listitem">
Murrell, P. (2013). Data intended for human consumption, not machine consumption. In <em>Bad data handbook</em> (pp. 31–51). O’Reilly Media.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./project-based-workflow.html" class="pagination-link" aria-label="Project-based workflow">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Project-based workflow</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./exploratory-data-analysis.html" class="pagination-link" aria-label="Exploratory data analysis">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/data4decisonmakers/data-concepts-applications/edit/main/12-data-entry-storage.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>